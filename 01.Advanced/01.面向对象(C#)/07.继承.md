# 继承

面向对象中的两个重要概念：**抽象** 和 **分类**.

抽象和分类是人们认识世界的基本方法.

抽象 ：将显示时间中客观存在的事务映射到意识中的一种方法.

分类 : 指确定这些抽象到意识中概念之间的关系.

这些关系的基本形式包括一般到特殊和整体与局部.

在面向对象中，一般到特殊的关系用 **继承（Inheritance）** 表示；整体与局部的关系用 **组合（Composition)** 表示.

## 继承的概念

继承是由已有的类创建新类的机制.

由继承得到的类称为 **子类（派生类)**, 被继承的类称为 **父类（超类 or 基类）**.

## 继承的作用

实现软件复用的重要方式

增强软件可扩展性

提高软件的可维护

## 继承的原则

- 子类继承父类的成员变量和成员方法

- 子类不继承父类的构造方法，能够继承父类的析构方法

- 子类不能删除父类成员，但可以重新定义父类成员

- 子类可以增加自己的成员

## object 类

- **object 是所有类中的基类，所有的类都会继承 object 类**

- base 类 虽然没有明确地继承某个类，但是 其隐性地默认地继承了 object 类

- 所以 继承 object 类 的类，都可以 继承使用 object 类 的 公有方法

![](Resource/02.png)


## 继承单一性

- 一个类只能继承一个父类，属于 **单一继承** ，且 具有 **传递性**.

- 但是，一个父类可以派生多个 子类，即 **多态**。

## 重写（override or new） --- 继承的特性

- 重写是子类对父类的允许访问的方法的实现过程进行重新编写, 返回值和形参都不能改变。即外壳不变，核心重写！

- 重写的好处在于子类可以根据需要，定义特定于自己的行为。 也就是说子类能够根据需要实现父类的方法。

- 重写方法不能抛出新的检查异常或者比被重写方法申明更加宽泛的异常。

    例如： 父类的一个方法申明了一个检查异常 IOException，但是在重写这个方法的时候不能抛出 Exception 异常，因为 Exception 是 IOException 的父类，只能抛出 IOException 的子类异常。


- 被重写的父类方法将被隐藏.

- 注意 ：程序中会出现警告，警告不影响程序执行
  
  - 消除警告的方法 : 
    - 在隐藏的属性或方法上（父类）追加 **Virtual 关键字**, 子类添加 **Override 关键字**。
    - 或者，直接在 子类添加 **new 关键字**，对父类不做任何更改.

## base - 维系了整个继承关系

base 用来引用当前对象的父类，用 base 可以实现对父类成员的访问。

```C#
// 访问父类被隐藏的成员变量，如 ：
base.variable;

// 调用父类中被覆盖的方法，如：
base.methodName(parameters lish) {}

// 调用父类的构造函数, 如:
派生类 构造函数(parameters list) ：base(parameters list) {}
```

## 上转型 - Upcasting

- Upcasting ： 使用父类的引用指代子类的实例
  
    例如对于 父类 - "人" 和 子类 - "学生"，可以说 学生是 "人".

- 上转型对像 可以访问子类继承或覆盖的成员，但是不能访问子类中新增的成员.

- 上转型对象 可以被重新赋值为子类实例，这时它有重新可以访问子类中新增成员.

```C#
using System;

namespace Lesson01
{
    

   // base 类
   // 虽然没有明确地继承某个类
   // 但是 其隐性地默认地继承了 object 类，object 是所有类中的基类
   class Shape
    {
        private string name;
        private int width;
        private int height;
        private string color;

        public Shape(string name, int width, int height, string color)
        {
            this.name = name;
            this.width = width;
            this.height = height;
            this.color = color;
        }

        public void setName(string name) { this.name = name; }

        public string getName() { return this.name; }

        public void setWidth(int width) { this.width = width; }

        public int getWidth() { return this.width; }

        public void setHeight(int height) { this.height = height; }

        public int getHeight() { return this.height; }

        public void setColor(string color) { this.color = color; }

        public string getColor() { return this.color; }

        // 父类 Print() 函数 设置为 virtual 将被子类 添加 override 重写
        public virtual void Print()
        {
            Console.WriteLine("Shape Name : " + this.name + "\tWidht : " + this.width + "\tHeight : " + this.height);
        }

        // 父类 printHello() 函数 将被子类 添加 new 重写
        public void PrintHello()
        {
            Console.WriteLine("Hello " + this.name);
        }

        public void DisplayColor()
        {
            Console.WriteLine("Color is " + this.color);
        }
    }

   // Rectangle 派生类
   class Rectangle : Shape
   {
        private int number;

        public Rectangle(string name, int width, int height, string color, int number) : base(name, width, height, color)
        {
            this.number = number;
        }

        public Rectangle(string name, int width, int height, string color) : base(name, width, height, color)
        {
            // empty
        }

        public int getArea()
        {
            return (getWidth() * getHeight());
        }

        // override - 子类重写 父类 Print()函数
        // 发生在父类和子类之间,父类 为 virtual 
        // 方法名称，参数，返回值一样
        public override void Print()
        {
            Console.WriteLine("派生类 Rectangle, 调用 父类 Print（）");
            base.Print();   // 调用 父类 Print()
            Console.WriteLine("Area : " + getArea() + "\tNumber : " + this.number);
        }

        // new - 子类重写 printHello() 函数
        public new void PrintHello()
        {
            Console.WriteLine("Hello {0} Class.", getName());
        }
   }

    // triangle 派生类
    class Trianle : Shape
    {
        private int number;

        public Trianle(string name, int width, int height, string color , int number) : base(name, width, height, color)
        {
            this.number = number;
        }

        public Trianle(string name, int width, int height, string color) : base(name, width, height, color)
        {
            // empty
        }

        public double getArea()
        {
            return (0.5 * getWidth() * getHeight());
        }

        // override - 子类重写 父类 Print()函数
        // 发生在父类和子类之间,父类 为 virtual 
        // 方法名称，参数，返回值一样
        public override void Print()
        {
            Console.WriteLine("派生类 Triangle, 调用 父类 Print（）");
            base.Print();   // 调用 父类 Print()
            Console.WriteLine("Area : " + getArea() + "\tNumber : " + this.number);
        }

        // new - 子类重写 printHello() 函数
        public new void PrintHello()
        {
            Console.WriteLine("Hello {0} Class.", getName());
        }
    }

    class FirstClass
    {
        static void Main(string[] args)
        {
            // base  类
            Shape s = new Shape("No name Shape", 20, 30, "blue");
            s.Print();

            Console.WriteLine();

            // 子类
            Rectangle r = new Rectangle("Rectangle", 100, 20, "red", 5);

            r.Print();                // 子类重写 父类 override
            r.DisplayColor();        //  继承 ： 子类可以拥有父类公有的属性和方法
            r.PrintHello();          // 子类重写 父类 new

            Console.WriteLine();

            Trianle t = new Trianle("Trianle", 20, 20, "green", 3);

            t.Print();              // 子类重写 父类 override
            t.DisplayColor();        // 继承 ： 子类可以拥有父类公有的属性和方法
            t.PrintHello();          // 子类重写 父类 new

            Console.WriteLine();

            // Upcasting - 隐式转换 
            Shape s1 = new Trianle("T1", 300, 40, "sky-blue");
            //Shape s1 = (Trianle)new Shape("T1", 300, 40, "sky-blue"); // 强制转换
            s1.Print();
        }
    }
}
```

```
output:

Shape Name : No name Shape      Widht : 20      Height : 30

派生类 Rectangle, 调用 父类 Print（）
Shape Name : Rectangle  Widht : 100     Height : 20
Area : 2000     Number : 5
Color is red
Hello Rectangle Class.

派生类 Triangle, 调用 父类 Print（）
Shape Name : Trianle    Widht : 20      Height : 20
Area : 200      Number : 3
Color is green
Hello Trianle Class.

派生类 Triangle, 调用 父类 Print（）
Shape Name : T1 Widht : 300     Height : 40
Area : 6000     Number : 0
```
